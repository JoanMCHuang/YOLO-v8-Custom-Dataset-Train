# -*- coding: utf-8 -*-
"""HW4_YOLOv8 自訂資料的模型訓練實測_20230318.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1G5cJFXzUBymQZpyOfSGXzl6vqR_jpVFD

# 上傳檔案
"""

# 上傳檔案 datasets.zip
from google.colab import files
files.upload();

"""# 解壓縮"""

#解壓縮
!unzip datasets.zip

"""## 上傳 data.yaml 檔案"""

# 上傳檔案 data.yaml
from google.colab import files
files.upload();

"""## 安裝 ultralytics """

!pip install ultralytics

"""## 模型訓練"""

!yolo task=detect mode=train model=yolov8s.pt data=/content/datasets/data.yaml epochs=5 imgsz=640

"""## 模型評分"""

!yolo task=detect mode=val model=/content/runs/detect/train5/weights/best.pt data=/content/datasets/data.yaml

"""## 顯示偵測圖片
可以看到大部分紙鈔都被加辨識框
"""

import matplotlib.pyplot as plt
import matplotlib.image as img
import os

image = img.imread('/content/runs/detect/val/val_batch1_labels.jpg')                       # 讀取圖片
plt.imshow(image)                                 
plt.show()

image = img.imread('/content/runs/detect/val/val_batch1_pred.jpg')                       # 讀取圖片
plt.imshow(image)                                 
plt.show()

image = img.imread('/content/runs/detect/val/val_batch2_pred.jpg')                       # 讀取圖片
plt.imshow(image)                                 
plt.show()

"""## 預測"""

!yolo task=detect mode=predict model=/content/runs/detect/train5/weights/best.pt conf=0.25 source=/content/datasets/test/images